"use strict";class DpPost{constructor(){if(this.ajax_post_request_=null,this.pdf_download_available_flag_=!1,this.constructor===DpPost)throw new Error("Abstract classes can't be instantiated.")}getAjaxRequestDataPayload(){throw new Error("Method 'getAjaxRequestDataPayload()' must be implemented.")}handleSucceededPostResponse(){throw new Error("Method 'handleSucceededPostResponse()' must be implemented.")}handleFailedPostResponse(){throw new Error("Method 'handleFailedPostResponse()' must be implemented.")}getGA4EventName(){throw new Error("Method 'getGA4EventName()' must be implemented.")}tagPostEventInGA4(){var ga4EventName=this.getGA4EventName();DpPgContext.tagPostEventInGA4(ga4EventName)}postAjaxDataPayload(resultElementId,payloadJSONData){this.tagPostEventInGA4(),DpDialog.showAlertMessage(dpWaitGettingResultString,DpImg.kImgSpinnerIcon);let self=this;this.ajax_post_request_=$.ajax({type:"POST",cache:!1,url:dpPgContext.ajax_post_url_,data:payloadJSONData,contentType:"application/json; charset=utf-8",beforeSend:function(){null!==self.ajax_post_request_&&self.ajax_post_request_.abort()},success:function(resultHTML){$(".dpPopup").slideUp(100);var payloadLookup=JSON.parse(payloadJSONData).dp_payload;if(DpKundaliContext.kUndefined===dpPageForm.kundali_.getContext)self.populateResultDivWithAJAXHTML(resultElementId,resultHTML);else if(DpKundaliContext.kMuhurta===dpPageForm.kundali_.getContext)dpActivityMuhurtaDates.showPersonalizedMuhurtaResult(payloadLookup,resultElementId,resultHTML);else if(DpKundaliContext.kKundaliList===dpPageForm.kundali_.getContext)handleKundaliListItemDBUpdateResponse(payloadLookup,resultHTML);else{if(DpKundaliContext.kKundali!==dpPageForm.kundali_.getContext&&DpKundaliContext.kMangalaDosha!==dpPageForm.kundali_.getContext&&DpKundaliContext.kKalasarpaDosha!==dpPageForm.kundali_.getContext)throw new Error("Undefined Kundali Context!");var kundaliDashaContextFlag=void 0!==payloadLookup.kundali_dasha,kundaliAnalysisContextFlag=void 0!==payloadLookup.kundali_analysis;kundaliDashaContextFlag?showVimshottariDashaTable(resultHTML):kundaliAnalysisContextFlag&&(DpDBKundaliContext.kEdit===dpPageForm.kundali_.getDBContext&&-100===dpPageForm.kundali_.getID&&dpPageToolbar.updateKundaliDataInLocalStorage(payloadLookup),kundaliDashaContextFlag=payloadLookup.kundali_analysis,dpPageToolbar.showKundaliAnalysisResult(kundaliDashaContextFlag,resultElementId,resultHTML),dpPageForm.handler_.updateCitySearchAndDatePickerValues(payloadLookup,resultHTML))}dpPageForm.form_submit_context_flag_&&(DpPost.performSubmitUXEffect(),$(".dpFloatKundaliAnalysisWrapper").remove(),dpPageForm.form_submit_context_flag_=!1),self.ajax_post_request_=null},error:function(){dpPageForm.form_submit_context_flag_=!1,DpDialog.showAlertMessage(dpFailedToGetResultString,DpImg.kImgErrorIcon),setTimeout(function(){$(".dpPopup").slideUp(100)},5e3),$(".dpDisabledButton").prop("disabled",!1).removeClass("dpDisabledButton"),DpPost.removePageOverlay(),self.ajax_post_request_=null}})}static removePageOverlay(){var pageOverlay=$("#dp-page-overlay");pageOverlay.is(":visible")&&pageOverlay.hide()}static evaluateAjaxScript(ajaxScriptMap){for(let scriptIdx=0;scriptIdx<ajaxScriptMap.length;scriptIdx++)window.eval(ajaxScriptMap[scriptIdx].innerHTML)}static performSubmitUXEffect(){DpKundaliContext.kKundali===dpPageForm.kundali_.getContext||DpKundaliContext.kMuhurta===dpPageForm.kundali_.getContext?($(".dpPopupForm").removeClass("dpPopupForm").hide(),DpPost.removePageOverlay()):document.querySelector(".dpResultFocusPoint").scrollIntoView({behavior:"smooth",block:"start"})}populateResultDivWithAJAXHTML(resultElementId,resultHTML){document.getElementById(resultElementId).innerHTML=resultHTML,this.pdf_download_available_flag_&&dpKundaliMatchPDFPost.createContextToDownloadPDF()}}class DpKundaliPost extends DpPost{getGA4EventName(){return"kundali_analysis"}getAjaxRequestDataPayload(){var kundali_=dpPageForm.kundali_,kundaliId=kundali_.getID,kundaliId=(kundali_.setName=null==kundali_.getName?"Not Set":kundali_.getName,DpDBKundaliContext.kNew===dpPageForm.kundali_.getDBContext&&-100!==kundaliId&&-99!==kundaliId?-1:kundaliId),kundaliId=(console.log("posted Kundali id = "+kundaliId+" with "+dpPageForm.kundali_.getDBContext+" context."),{kundali_id:kundaliId.toString(),kundali_name:kundali_.getName,kundali_gender:kundali_.getGender,kundali_date:kundali_.getDate,kundali_time:kundali_.getTime,kundali_date_type:kundali_.getDateType,kundali_city:kundali_.geo_.getCity,kundali_state:kundali_.geo_.getState,kundali_country:kundali_.geo_.getCountry,kundali_latitude:kundali_.geo_.getLatitude,kundali_longitude:kundali_.geo_.getLongitude,kundali_olson_timezone:kundali_.geo_.getOlsonTimezone,kundali_timezone_offset:kundali_.geo_.getTimezoneOffset,kundali_elevation:kundali_.geo_.getElevation,kundali_tag:kundali_.getKundaliTag});return document.getElementById("dp-ayanamsha")&&(kundaliId.kundali_ayanamsha=kundali_.getAyanamsha),kundali_.setDateType="gregorian",DpDBKundaliContext.kEdit===dpPageForm.kundali_.getDBContext||DpDBKundaliContext.kListItemEdit===dpPageForm.kundali_.getDBContext?kundaliId.kundali_db_context=DpDBKundaliContext.kEdit:!0===dpPageForm.form_submit_context_flag_||DpDBKundaliContext.kSave===dpPageForm.kundali_.getDBContext||DpDBKundaliContext.kNew===dpPageForm.kundali_.getDBContext||DpDBKundaliContext.kListItemSave===dpPageForm.kundali_.getDBContext?kundaliId.kundali_db_context=DpDBKundaliContext.kSave:DpDBKundaliContext.kListItemDelete===dpPageForm.kundali_.getDBContext&&(kundaliId.kundali_db_context=DpDBKundaliContext.kDelete),kundaliId.kundali_context=dpPageForm.kundali_.getContext,kundaliId}}class DpTwinKundaliPost extends DpPost{constructor(){super(),this.pdf_download_available_flag_=!0}getGA4EventName(){return"kundali_match"}getAjaxRequestDataPayload(){var kundali_=dpPageForm.kundali_,kundali_ext_=dpPageForm.kundali_ext_,ajaxDataPayload={kundali_id:kundali_.getID,kundali_name:kundali_.getName,kundali_date:kundali_.getDate,kundali_time:kundali_.getTime,kundali_city:kundali_.geo_.getCity,kundali_state:kundali_.geo_.getState,kundali_country:kundali_.geo_.getCountry,kundali_latitude:kundali_.geo_.getLatitude,kundali_longitude:kundali_.geo_.getLongitude,kundali_elevation:kundali_.geo_.getElevation,kundali_olson_timezone:kundali_.geo_.getOlsonTimezone,kundali_timezone_offset:kundali_.geo_.getTimezoneOffset,second_kundali_id:kundali_ext_.getID,second_kundali_name:kundali_ext_.getName,second_kundali_date:kundali_ext_.getDate,second_kundali_time:kundali_ext_.getTime,second_kundali_city:kundali_ext_.geo_.getCity,second_kundali_state:kundali_ext_.geo_.getState,second_kundali_country:kundali_ext_.geo_.getCountry,second_kundali_latitude:kundali_ext_.geo_.getLatitude,second_kundali_longitude:kundali_ext_.geo_.getLongitude,second_kundali_elevation:kundali_ext_.geo_.getElevation,second_kundali_olson_timezone:kundali_ext_.geo_.getOlsonTimezone,second_kundali_timezone_offset:kundali_ext_.geo_.getTimezoneOffset};return document.getElementById("dp-ayanamsha")&&(ajaxDataPayload.kundali_ayanamsha=kundali_.getAyanamsha,ajaxDataPayload.second_kundali_ayanamsha=kundali_ext_.getAyanamsha),dpPageForm.form_submit_context_flag_&&(ajaxDataPayload.kundali_db_context=!0,ajaxDataPayload.second_kundali_db_context=!0),ajaxDataPayload}}class DpGeoPost extends DpPost{getAjaxDeleteRequestPayload(){return{"drik-post-command":DpGeoDBContext.kDelete}}getGA4EventName(){return"custom_geo"}getAjaxRequestDataPayload(){return{user_city:dpPageForm.geo_.getCity,user_state:dpPageForm.geo_.getState,user_country:dpPageForm.geo_.getCountry,user_latitude:dpPageForm.geo_.getLatitude,user_longitude:dpPageForm.geo_.getLongitude,user_olson_timezone:dpPageForm.geo_.getOlsonTimezone,user_elevation:dpPageForm.geo_.getElevation,"drik-post-command":dpPageForm.geo_.getDBContext}}postAjaxDataPayload(resultElementId,payloadData){this.tagPostEventInGA4();let self=this;this.ajax_post_request_=$.ajax({type:"POST",url:DpPg.kNewCityPost,data:JSON.stringify({dp_payload:payloadData}),contentType:"application/json; charset=utf-8",beforeSend:function(){null!==self.ajax_post_request_&&self.ajax_post_request_.abort()},success:function(result){DpDialog.showAlertMessage("<br>"+dpCityAddedSuccessfullyString,DpImg.kImgCheckMarkIcon),setTimeout(function(){$(".dpPopup").slideUp(100)},5e3),dpSignIn.authenticated_user_flag_?window.location=DpPg.kGeoDetails:window.location.reload(),self.ajax_post_request_=null},error:function(){DpDialog.showAlertMessage(dpFailedToAddCityString,DpImg.kImgErrorIcon),setTimeout(function(){$(".dpPopup").slideUp(100)},5e3),self.ajax_post_request_=null}})}}let dpKundaliPost=new DpKundaliPost,dpTwinKundaliPost=new DpTwinKundaliPost,dpGeoPost=new DpGeoPost;