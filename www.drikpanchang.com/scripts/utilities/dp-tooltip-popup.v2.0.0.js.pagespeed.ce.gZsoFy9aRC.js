"use strict";class DpTooltipPopup{createTooltipLocalCache(){throw new Error("Method 'createTooltipLocalCache()' must be implemented.")}adjustElementPopupVisibility(){throw new Error("Method 'adjustElementPopupVisibility()' must be implemented.")}constructor(){this.post_url_=null,this.tooltip_popup_cache_=[],this.unicode_icon_html_value_=null,this.ajax_post_request_=null,this.dictionary_cache_key_=null}showElementPopupFromCache(event,elementTooltip){var popupWrapperElement=$(event.target).parent(),elementTooltip=elementTooltip.replace("dpElementInfoPopupContent","dpElementInfoPopupContentCache");$(popupWrapperElement).append(elementTooltip),this.adjustElementPopupVisibility(),this.handleElementPopupDismiss(event.target)}postElementPopupAjaxPayload(event,popupWrapperElement,payloadData){let self=this;this.ajax_post_request_=$.ajax({type:"POST",cache:!1,url:self.post_url_,data:JSON.stringify({dp_payload:payloadData}),contentType:"application/json; charset=utf-8",timeout:5e3,beforeSend:function(){null!==self.ajax_post_request_&&self.ajax_post_request_.abort(),self.showWaitIcon(event)},success:function(elementTooltipHTML){self.closeAjaxRequestElementPopup(),$(".dpElementInfoPopupContentCache").is(":visible")&&$(".dpElementInfoPopupContent").remove(),self.createTooltipLocalCache(payloadData,elementTooltipHTML),self.restoreElementIcons(event,popupWrapperElement),$(popupWrapperElement).append(elementTooltipHTML),self.adjustElementPopupVisibility(),self.handleElementPopupDismiss(event.target),self.ajax_post_request_=null},error:function(xhr,status,error){"abort"!==status&&(self.showPlaceholderPopupOnError(popupWrapperElement,dpPopupErrorMessage),setTimeout(function(){self.closeElementPlaceholderPopup()},2e3)),self.restoreElementIcons(event,popupWrapperElement),self.ajax_post_request_=null}})}showPlaceholderPopupOnError(event,messageText){var elementPopup=document.createElement("div"),elementPopupHeader=(elementPopup.className="dpElementInfoPopupPlaceholder",document.createElement("div")),closeButton=(elementPopupHeader.className="dpElementInfoPopupHeader",document.createElement("span"));closeButton.className="dpClosePlaceholderInfoPopup",closeButton.innerHTML="X",elementPopupHeader.appendChild(closeButton),elementPopup.appendChild(elementPopupHeader),""!==messageText&&((closeButton=document.createElement("div")).className="dpErrorMessage",closeButton.innerHTML=messageText,elementPopup.appendChild(closeButton)),$(event).append(elementPopup);let self=this;$("body, .dpClosePlaceholderInfoPopup").on("click",function(){self.closeElementPlaceholderPopup()})}handleElementPopupDismiss(targetElement){let self=this,elementIconClicked=!1;$(targetElement).on("click",function(e){e.stopPropagation(),elementIconClicked=!0}),$(targetElement).on("mouseleave",function(){elementIconClicked||self.closeVisiblePopups()}),this.closePopupOnCloseButtonClick()}closePopupOnCloseButtonClick(){let self=this;$(".dpElementInfoPopupContent, .dpElementInfoPopupContentCache").on("click",function(e){e.stopPropagation()}),$("body, .dpCloseElementInfoPopup").on("click",function(){self.closeVisiblePopups()})}closeVisiblePopups(){this.closeAjaxRequestElementPopup(),this.closeCachedElementPopup()}closeAjaxRequestElementPopup(){this.closeElementPopup(".dpElementInfoPopupContent")}closeCachedElementPopup(){this.closeElementPopup(".dpElementInfoPopupContentCache")}closeElementPopup(selectorElement){$(selectorElement).is(":visible")&&($(selectorElement).remove(),$("body, .dpCloseElementInfoPopup").off("click"))}closeElementPlaceholderPopup(){$(".dpElementInfoPopupPlaceholder").is(":visible")&&$(".dpElementInfoPopupPlaceholder").remove()}showWaitIcon(event){var loadingSpan,popupWrapperElement=$(event.target).parent();"IMG"===event.target.tagName?($(event.target).hide(),(loadingSpan=document.createElement("div")).className="dpInfoIcon dpLoadingIcon",$(popupWrapperElement).append(loadingSpan)):"dpTableElementUnicodeImage"===event.target.className||"dpElementUnicodeImage"===event.target.className?(this.unicode_icon_html_value_=event.target.innerHTML,event.target.innerHTML="",$(event.target).addClass("dpInfoIcon dpLoadingIcon")):(event.target.innerHTML="",$(event.target).addClass("dpLoadingIcon"))}restoreElementIcons(event,popupWrapperElement){"IMG"===event.target.tagName?($(popupWrapperElement).find(".dpInfoIcon").remove(),$(event.target).show(),$(popupWrapperElement).append(event.target)):null!==this.unicode_icon_html_value_?($(event.target).removeClass("dpInfoIcon dpLoadingIcon"),event.target.innerHTML=this.unicode_icon_html_value_,this.unicode_icon_html_value_=null):($(event.target).removeClass("dpLoadingIcon"),""===event.target.innerHTML&&(event.target.innerHTML="&#9432;"))}createTooltipLocalCacheInner(cachePrimaryKey,cacheAuxKey,elementTooltipHTML){var tooltipHTMLLookup;void 0!==dpPageTooltipPopup.tooltip_popup_cache_[cachePrimaryKey]?Object.keys(dpPageTooltipPopup.tooltip_popup_cache_).map(function(objectKey){dpPageTooltipPopup.tooltip_popup_cache_[objectKey][cacheAuxKey]=elementTooltipHTML}):((tooltipHTMLLookup=[])[cacheAuxKey]=elementTooltipHTML,dpPageTooltipPopup.tooltip_popup_cache_[cachePrimaryKey]=tooltipHTMLLookup)}}class DpKundaliTooltipPopup extends DpTooltipPopup{constructor(){super(),this.post_url_=DpPg.kTooltipKundali,this.tooltip_expiry_=86400,this.dictionary_cache_key_="yoga-tooltip-dictionary"}createTooltipLocalCache(payloadData,elementTooltipHTML){let yogaTooltipDictionary={};var singleYogaTooltipObject={};singleYogaTooltipObject[payloadData.kundali_yoga_info]={value:elementTooltipHTML,timestamp:(new Date).getTime()+1e3*this.tooltip_expiry_};try{null!==localStorage.getItem(this.dictionary_cache_key_)?(yogaTooltipDictionary=JSON.parse(localStorage.getItem(this.dictionary_cache_key_)),Object.assign(yogaTooltipDictionary,singleYogaTooltipObject)):yogaTooltipDictionary=Object.assign({},singleYogaTooltipObject),localStorage.setItem(this.dictionary_cache_key_,JSON.stringify(yogaTooltipDictionary))}catch(e){console.log(e)}}adjustElementPopupVisibility(){var elementPopup=document.querySelector(".dpElementInfoPopupContent, .dpElementInfoPopupContentCache"),elementBounding=elementPopup.getBoundingClientRect(),dialogHeight=$("[aria-describedby=dp-kundali-yoga-id]").height();elementBounding.bottom>dialogHeight&&$(elementPopup).css({bottom:"114%"})}}class DpPanchangamTooltipPopup extends DpTooltipPopup{constructor(){super(),this.post_url_=DpPg.kTooltipPanchangam}adjustElementPopupVisibility(){var elementPopup;dpEssential.mobile_device_flag_||(elementPopup=document.querySelector(".dpElementInfoPopupContent, .dpElementInfoPopupContentCache")).getBoundingClientRect().bottom>(window.innerHeight||document.documentElement.clientHeight)&&$(elementPopup).css({bottom:"114%"})}createTooltipLocalCache(payloadData,elementTooltipHTML){var payloadData=payloadData.panchang_element_info.split("="),panchangElementKey=payloadData[0],payloadData=payloadData[1].split(";")[0];this.createTooltipLocalCacheInner(panchangElementKey,payloadData,elementTooltipHTML)}}class DpDainikaMuhurtaTooltipPopup extends DpTooltipPopup{constructor(){super(),this.post_url_=DpPg.kTooltipDainikaMuhurta}adjustElementPopupVisibility(){var elementPopup;dpEssential.mobile_device_flag_||(elementPopup=document.querySelector(".dpElementInfoPopupContent, .dpElementInfoPopupContentCache")).getBoundingClientRect().bottom>(window.innerHeight||document.documentElement.clientHeight)&&$(elementPopup).css({bottom:"114%"})}createTooltipLocalCache(payloadData,elementTooltipHTML){var muhurtaType=payloadData["muhurta-type"],payloadData=payloadData["muhurta-row-no"];this.createTooltipLocalCacheInner(muhurtaType,payloadData,elementTooltipHTML)}}class DpActivityMuhurtaTooltipPopup extends DpTooltipPopup{constructor(){super(),this.post_url_=DpPg.kTooltipActivityMuhurta}adjustElementPopupVisibility(){var elementPopup,elementBounding,elementPopupParent;dpEssential.mobile_device_flag_||(elementBounding=(elementPopup=document.querySelector(".dpElementInfoPopupContent, .dpElementInfoPopupContentCache")).getBoundingClientRect(),elementPopupParent=elementPopup.parentElement,elementPopupParent=$(elementPopupParent).closest(".dpTimelineIntervalAccordionPanel").height()-$(elementPopupParent).position().top+10,elementBounding.bottom>(window.innerHeight||document.documentElement.clientHeight)&&$(elementPopup).css({bottom:elementPopupParent+"px"}))}createTooltipLocalCache(payloadData,elementTooltipHTML){var payloadData=payloadData.interval_tag_meta.split(",")[1],pageURL=location.pathname;this.createTooltipLocalCacheInner(pageURL,payloadData,elementTooltipHTML)}}