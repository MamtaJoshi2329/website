"use strict";class DpPDFPost{constructor(){if(this.ajax_post_request_=null,this.pdf_name_=null,this.error_message_=null,this.wait_message_=null,this.premium_feature_message_=null,this.premium_feature_signin_message_=null,this.constructor===DpPDFPost)throw new Error("Abstract classes can't be instantiated.")}getAjaxRequestDataPayload(){throw new Error("Method 'getAjaxRequestDataPayload()' must be implemented.")}getGA4EventName(){throw new Error("Method 'getGA4EventName()' must be implemented.")}tagPostEventInGA4(){var ga4EventName=this.getGA4EventName();DpPgContext.tagPostEventInGA4(ga4EventName)}postAjaxDataPayload(payloadData,ajaxPostURL){this.tagPostEventInGA4();let self=this;this.ajax_post_request_=$.ajax({method:"POST",url:ajaxPostURL,data:JSON.stringify({dp_payload:payloadData}),xhrFields:{responseType:"blob"},beforeSend:function(){null!==self.ajax_post_request_&&self.ajax_post_request_.readyState<4&&(console.log("beforeSend() - previous request aborted successfully..."),self.ajax_post_request_.abort())},success:function(data){setTimeout(function(){$(".dpPopup").slideUp(100)},2e3),self.handlePDFDataDump(data),self.enableUIButtons()},error:function(xhr,ajaxOptions,thrownError){"abort"!==thrownError&&"undefined"!==thrownError&&(DpDialog.showAlertMessage(self.error_message_,DpImg.kImgErrorIcon),setTimeout(function(){$(".dpPopup").slideUp(100)},5e3),console.log(thrownError+"\r\n"+xhr.statusText+"\r\n"+xhr.responseText)),self.enableUIButtons()}})}handlePDFDataDump(data){let fileURL;window.navigator&&window.navigator.msSaveOrOpenBlob?(fileURL=new Blob([data],{type:"application/pdf"}),window.navigator.msSaveOrOpenBlob(fileURL,this.pdf_name_)):(fileURL=window.URL.createObjectURL(new Blob([data],{type:"application/pdf"})),(data=document.createElement("a")).href=fileURL,data.download=this.pdf_name_,data.style.display="none",document.body.appendChild(data),data.click(),window.URL.revokeObjectURL(fileURL))}enableUIButtons(){}}class DpCalendarPDFPost extends DpPDFPost{constructor(){super(),this.calendar_pdf_year_=0,this.grid_view_=null,this.panchang_base_=null,this.panchang_clock_=null,this.panchang_school_=null,this.panchang_theme_=null,this.time_format_=null}getGA4EventName(){return"pdf_calendar"}registerButtonClickListeners(){let self=this;$("#dpDownloadPDFItemId, .dpCalendarPDFDownload").on("click",function(){var payloadData;dpSignIn.drik_ads_free_flag_?(DpDialog.showAlertMessage(self.wait_message_,DpImg.kImgSpinnerIcon),payloadData=self.getAjaxRequestDataPayload(this),self.postAjaxDataPayloadForPDFCreation(payloadData)):dpSignIn.authenticated_user_flag_?dpSubscription.showPremiumFeatureDialog(self.premium_feature_message_):dpSubscription.showPremiumFeatureSignInDialog(self.premium_feature_signin_message_)})}getAjaxRequestDataPayload(thisRef){var thisRef=$(thisRef).attr("data-download-pdf");let geonameId=dpPgContext.geoname_id_,panchangSchoolKey=this.panchang_school_;return null!=thisRef&&(thisRef=thisRef.split("|"),geonameId=thisRef[0],panchangSchoolKey=thisRef[1]),{calendar_type:dpPgContext.calendar_type_,pdf_context:"create",timeline_geoname_id:geonameId,panchang_school:panchangSchoolKey,calendar_year:this.calendar_pdf_year_,grid_view:this.grid_view_,panchang_base:this.panchang_base_,clock_type:this.panchang_clock_,panchang_theme:this.panchang_theme_,time_format:this.time_format_}}postAjaxDataPayloadForPDFCreation(payloadData){let self=this;$.ajax({type:"POST",url:dpPgContext.ajax_post_url_,data:JSON.stringify({dp_payload:payloadData}),contentType:"application/json; charset=utf-8",success:function(result){self.handlePDFDownloadAJAXResponse(result,payloadData)},error:function(){DpDialog.showAlertMessage(self.error_message_,DpImg.kImgErrorIcon),setTimeout(function(){$(".dpPopup").slideUp(100)},6e3)}})}handlePDFDownloadAJAXResponse(serverResponse,payloadData){$.trim(serverResponse)?(console.log(serverResponse),DpDialog.showAlertMessage(this.error_message_,DpImg.kImgErrorIcon),setTimeout(function(){$(".dpPopup").slideUp(100)},8e3)):(payloadData.pdf_context="",this.postAjaxDataPayload(payloadData,dpPgContext.ajax_post_url_))}}class DpKundaliMatchPDFPost extends DpPDFPost{getGA4EventName(){return"pdf_kundali_match"}createContextToDownloadPDF(){let self=this,downloadButton=(this.error_message_=dpFailedToGetResultString,$(".dpDownloadButton"));downloadButton.on("click",function(){var payloadData;dpSignIn.drik_ads_free_flag_?(downloadButton.prop("disabled",!0).addClass("dpDisabledButton"),DpDialog.showAlertMessage(self.wait_message_,DpImg.kImgSpinnerIcon),payloadData=self.getAjaxRequestDataPayload(),self.preparePDFName(),self.postAjaxDataPayload(payloadData,dpPgContext.ajax_pdf_post_url_)):dpSignIn.authenticated_user_flag_?dpSubscription.showPremiumFeatureDialog(self.premium_feature_message_):dpSubscription.showPremiumFeatureSignInDialog(self.premium_feature_signin_message_)})}getAjaxRequestDataPayload(){var payloadData=dpTwinKundaliPost.getAjaxRequestDataPayload();return payloadData.post_context="pdf",payloadData}preparePDFName(){let boyPDFName=dpPageForm.kundali_.getName.split(" ")[0],girlPDFName=dpPageForm.kundali_ext_.getName.split(" ")[0];boyPDFName=boyPDFName.charAt(0).toUpperCase()+boyPDFName.slice(1),girlPDFName=girlPDFName.charAt(0).toUpperCase()+girlPDFName.slice(1),this.pdf_name_=boyPDFName+"-"+girlPDFName+"-Kundali-Match-By-Drik-Panchang.pdf"}enableUIButtons(){var downloadButton=$(".dpDownloadButton");downloadButton.prop("disabled",!1),downloadButton.removeClass("dpDisabledButton")}}let dpCalendarPDFPost=new DpCalendarPDFPost,dpKundaliMatchPDFPost=new DpKundaliMatchPDFPost;