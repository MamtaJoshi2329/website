"use strict";var dpDoshaTimelineHTMLCache=null,dpDoshaTimelineDateTitle=null,dpDoshaTimelinePostRequest=null;function handleDoshaTimelineButtonClick(){null!==dpDoshaTimelineHTMLCache?showDoshaTimelinePopupDialog(dpDoshaTimelineHTMLCache):(DpDialog.showAlertMessage(dpWaitGettingResultString,DpImg.kImgSpinnerIcon),showDoshaTimelineWithPostedAjaxData())}function showDoshaTimelineWithPostedAjaxData(){var day=dpTimeContext.page_js_date_.getDate(),month=dpTimeContext.page_js_date_.getMonth()+1,year=dpTimeContext.page_js_date_.getFullYear(),day=DpDtTiUtils.getFormattedDDMMYYYYDate(day+"/"+month+"/"+year),month={dp_payload:{calendar_type:dpPgContext.calendar_type_,panchang_page_date:day,timeline_geoname_id:dpPgContext.geoname_id_}},year=JSON.stringify(month);dpDoshaTimelinePostRequest=$.ajax({type:"POST",cache:!1,url:dpPgContext.ajax_post_url_,data:year,contentType:"application/json; charset=utf-8",beforeSend:function(){null!==dpDoshaTimelinePostRequest&&dpDoshaTimelinePostRequest.abort()},success:function(resultHTML){dpDoshaTimelineHTMLCache=resultHTML,dpEssential.mobile_device_flag_?(setTimeout(function(){$(".dpPopup").slideUp(100)},0),showDoshaTimelinePopupDialog(resultHTML)):($(".dpDoshaTimelineTitle").css({display:"block"}),document.getElementById("dp-panchangam-dosha-timeline").innerHTML=resultHTML),dpDoshaTimelinePostRequest=null},error:function(){dpEssential.mobile_device_flag_&&(DpDialog.showAlertMessage(dpFailedToGetResultString,DpImg.kImgErrorIcon),setTimeout(function(){$(".dpPopup").slideUp(100)},5e3)),console.error("Oops some error occurred, failed to get Dosha Timeline!"),dpDoshaTimelinePostRequest=null}})}function showDoshaTimelinePopupDialog(doshaTimelineHTML){var timelineToolbarButton=$(".dpDoshaTimelineItemLabel").parent(),timelineButtonLinkHref=timelineToolbarButton.attr("href"),doshaTimelineHTML=(timelineToolbarButton.attr("href","javascript:void(0);"),timelineToolbarButton.prop("disabled",!0).addClass("dpDisabledButton"),dpDialogHeightTopMargin=0,dpSettingsToolbar.createDialogPopup(doshaTimelineHTML,600,900,20,"dp-timeline-dialog-id"));doshaTimelineHTML.bind("dialogclose",function(event,ui){dpSettingsToolbar.customizeDialogBind(event),timelineToolbarButton.prop("disabled",!1).removeClass("dpDisabledButton"),timelineToolbarButton.attr("href",timelineButtonLinkHref)});var doshaTimelineTitle=$(".dpDoshaTimelineTitle").data("timeline-title");doshaTimelineHTML.dialog("option","title",doshaTimelineTitle),null==dpDoshaTimelineDateTitle&&(dpDoshaTimelineDateTitle=$(".dpTimelineDateTitle").addClass("dpDoshaTimelineTitle")),$(".dpTimelineContainer").prepend(dpDoshaTimelineDateTitle)}