"use strict";const DpKundaliChartFont={kGrahaLabel:"15px monospace",kRashiLabel:"12px monospace",kCanvas:"13px monospace",kWatermark:"12px monospace",kCanvasSmaller:"10px monospace"},DpKundaliSize=(Object.freeze(DpKundaliChartFont),{kChartWidth:400,kChartHeight:266.67,kSwastikaSize:0,kAxisYAdjustment:8}),DpKundaliChartLabel=(Object.freeze(DpKundaliSize),{kWatermark:"Drikp.com"}),DpKundaliCanvasID=(Object.freeze(DpKundaliChartLabel),{kPrimary:"dp-kundali-chart-canvas",kSecondary:"dp-kundali-chart-canvas-second",kPoppedOut:"dp-kundali-chart-canvas-popped-out"});Object.freeze(DpKundaliCanvasID);class DpKundaliChart{constructor(){this.canvas_id_list_=[],this.critical_points_list_={},this.house_no_position_list_={},this.graha_position_list_={},this.rashi_position_list_={},this.chart_style_list_={},this.geo_tag_list_={},this.placeholder_critical_points_={},this.chart_width_=DpKundaliSize.kChartWidth,this.chart_height_=DpKundaliSize.kChartHeight,this.swastika_size_=DpKundaliSize.kSwastikaSize,this.rashi_hex_color_=null,this.line_hex_color_=null,this.house_no_hex_color_=null,this.dot_fill_hex_color_=null,this.background_hex_color_=null,this.watermark_hex_color_=null,this.background_image_url_=null,this.graha_label_hex_color_list_=[],this.canvas_font_=DpKundaliChartFont.kCanvas,this.canvas_smaller_font_=DpKundaliChartFont.kCanvasSmaller,this.graha_label_font_=DpKundaliChartFont.kGrahaLabel,this.rashi_label_font_=DpKundaliChartFont.kRashiLabel,this.watermark_font_=DpKundaliChartFont.kWatermark,this.axis_y_adjustment_=DpKundaliSize.kAxisYAdjustment,this.x1_=0,this.x2_=0,this.x3_=0,this.x4_=0,this.x5_=0,this.x6_=0,this.x7_=0,this.y1_=0,this.y2_=0,this.y3_=0,this.y4_=0,this.y5_=0,this.y6_=0,this.y7_=0}drawAllKundaliChartOnCanvas(){let self=this;this.canvas_id_list_.forEach(function(canvasId){self.drawKundaliChartOnCanvas(canvasId),console.log("chart with chartCanvasId = "+canvasId+" drawn")})}redrawKundaliChartOnCanvas(chartCanvasId){this.drawKundaliChartOnCanvas(chartCanvasId)}drawKundaliChartOnCanvas(chartCanvasId){var canvasPaintContext,deviceDPR,canvasRect,kundaliChartCanvas=document.getElementById(chartCanvasId);kundaliChartCanvas&&kundaliChartCanvas.getContext&&(canvasPaintContext=kundaliChartCanvas.getContext("2d"),deviceDPR=window.devicePixelRatio,canvasRect=kundaliChartCanvas.getBoundingClientRect(),kundaliChartCanvas.width=this.chart_width_*deviceDPR,kundaliChartCanvas.height=this.chart_height_*deviceDPR,canvasPaintContext.scale(deviceDPR,deviceDPR),kundaliChartCanvas.style.width=0!==canvasRect.width?canvasRect.width+"px":dpKundaliChart.chart_width_+"px",kundaliChartCanvas.style.height=0!==canvasRect.height?canvasRect.height+"px":dpKundaliChart.chart_height_+"px",canvasPaintContext.font=this.getChartCanvasFontSize(),canvasPaintContext.lineWidth=1,canvasPaintContext.strokeStyle=this.line_hex_color_,canvasPaintContext.fillStyle=this.background_hex_color_,canvasPaintContext.fillRect(0,0,kundaliChartCanvas.width,kundaliChartCanvas.height),this.swastika_size_=kundaliChartCanvas.width/(40*deviceDPR),this.drawCanvasBackgroundImage(chartCanvasId),this.drawKundaliChart(chartCanvasId))}getChartCanvasFontSize(){let fontSize=this.canvas_font_;var pageLanguage=dpCookiesMngr.getCookie("drik-language");return"hi"===pageLanguage||"mr"===pageLanguage||"en"===pageLanguage?fontSize=this.canvas_font_:"ta"!==pageLanguage&&"te"!==pageLanguage&&"ml"!==pageLanguage||(fontSize=this.canvas_smaller_font_),fontSize}drawCanvasBackgroundImage(chartCanvasId){if(null!=this.background_image_url_){let backgroundImage=new Image;backgroundImage.src=this.background_image_url_,backgroundImage.onload=function(){document.getElementById(chartCanvasId).getContext("2d").drawImage(backgroundImage,0,0)}}}drawKundaliChart(chartCanvasId){this.setElementCoordinates(chartCanvasId),this.drawKundaliChartOuterRectangle(chartCanvasId),this.drawChartCommonCoreShape(chartCanvasId);var canvasPaintContext=document.getElementById(chartCanvasId).getContext("2d"),chartStyle=(canvasPaintContext.globalAlpha=.75,this.chart_style_list_[chartCanvasId]);"east"===chartStyle?this.drawEastKundaliChartLines(chartCanvasId):"south"===chartStyle?this.drawSouthKundaliChartLines(chartCanvasId):this.drawNorthKundaliChartLines(chartCanvasId),this.drawDrikpanchangWatermark(chartCanvasId),canvasPaintContext.globalAlpha=1,this.drawHouseNumbersOnCanvas(chartCanvasId,this.house_no_position_list_[chartCanvasId]),this.drawPlanetLabelsOnCanvas(chartCanvasId,this.graha_position_list_[chartCanvasId]),this.drawZodiacLabelsOnCanvas(chartCanvasId,this.rashi_position_list_[chartCanvasId])}setElementCoordinates(chartCanvasId){this.calculateElementDimension(chartCanvasId),this.calculateBasicDrawingCoordinates(chartCanvasId)}calculateElementDimension(chartCanvasId){chartCanvasId=document.getElementById(chartCanvasId);this.chart_width_=0!==this.chart_width_?this.chart_width_:chartCanvasId.offsetWidth,this.chart_height_=0!==this.chart_height_?this.chart_height_:chartCanvasId.offsetHeight}calculateBasicDrawingCoordinates(chartCanvasId){chartCanvasId=this.critical_points_list_[chartCanvasId];this.x1_=chartCanvasId[0][0],this.x2_=chartCanvasId[1][0],this.x3_=chartCanvasId[2][0],this.x4_=chartCanvasId[3][0],this.x5_=chartCanvasId[4][0],this.x6_=chartCanvasId[5][0],this.x7_=chartCanvasId[6][0],this.y1_=chartCanvasId[0][1],this.y2_=chartCanvasId[1][1],this.y3_=chartCanvasId[2][1],this.y4_=chartCanvasId[3][1],this.y5_=chartCanvasId[4][1],this.y6_=chartCanvasId[5][1],this.y7_=chartCanvasId[6][1]}drawKundaliChartOuterRectangle(chartCanvasId){chartCanvasId=document.getElementById(chartCanvasId).getContext("2d");chartCanvasId.moveTo(this.x3_,this.y3_),chartCanvasId.lineTo(this.x5_,this.y3_),chartCanvasId.lineTo(this.x5_,this.y5_),chartCanvasId.lineTo(this.x3_,this.y5_),chartCanvasId.lineTo(this.x3_,this.y3_),chartCanvasId.stroke()}drawChartCommonCoreShape(chartCanvasId){var chartCanvasId=document.getElementById(chartCanvasId).getContext("2d"),halfSwastikaSize=this.swastika_size_/2;chartCanvasId.beginPath(),chartCanvasId.moveTo(this.x1_-this.swastika_size_,this.y1_-this.swastika_size_),chartCanvasId.lineTo(this.x1_-this.swastika_size_,this.y1_),chartCanvasId.lineTo(this.x1_+this.swastika_size_,this.y1_),chartCanvasId.lineTo(this.x1_+this.swastika_size_,this.y1_+this.swastika_size_),chartCanvasId.moveTo(this.x1_-this.swastika_size_,this.y1_+this.swastika_size_),chartCanvasId.lineTo(this.x1_,this.y1_+this.swastika_size_),chartCanvasId.lineTo(this.x1_,this.y1_-this.swastika_size_),chartCanvasId.lineTo(this.x1_+this.swastika_size_,this.y1_-this.swastika_size_),chartCanvasId.fillStyle=this.dot_fill_hex_color_,chartCanvasId.fillRect(this.x1_-halfSwastikaSize,this.y1_-halfSwastikaSize,1,1),chartCanvasId.fillRect(this.x1_+halfSwastikaSize,this.y1_-halfSwastikaSize,1,1),chartCanvasId.fillRect(this.x1_-halfSwastikaSize,this.y1_+halfSwastikaSize,1,1),chartCanvasId.fillRect(this.x1_+halfSwastikaSize,this.y1_+halfSwastikaSize,1,1)}drawNorthKundaliChartLines(chartCanvasId){var chartCanvasId=document.getElementById(chartCanvasId).getContext("2d"),curvePoint=(chartCanvasId.moveTo(this.x1_-this.swastika_size_,this.y1_-this.swastika_size_),chartCanvasId.lineTo(this.x3_,this.y3_),chartCanvasId.moveTo(this.x1_+this.swastika_size_,this.y1_-this.swastika_size_),chartCanvasId.lineTo(this.x5_,this.y3_),chartCanvasId.moveTo(this.x1_-this.swastika_size_,this.y1_+this.swastika_size_),chartCanvasId.lineTo(this.x3_,this.y5_),chartCanvasId.moveTo(this.x1_+this.swastika_size_,this.y1_+this.swastika_size_),chartCanvasId.lineTo(this.x5_,this.y5_),chartCanvasId.moveTo(this.x1_,this.y3_),this.chart_width_/7),adjustedCurvePoint=1.3*curvePoint;chartCanvasId.bezierCurveTo(this.x1_,this.y3_+curvePoint,this.x4_,this.y2_-curvePoint,this.x7_,this.y6_),chartCanvasId.bezierCurveTo(this.x7_+curvePoint,this.y6_,this.x5_-curvePoint,this.y1_,this.x5_,this.y1_),chartCanvasId.bezierCurveTo(this.x5_-adjustedCurvePoint,this.y1_,this.x4_+curvePoint,this.y4_,this.x7_,this.y7_),chartCanvasId.bezierCurveTo(this.x7_,this.y7_+curvePoint,this.x1_,this.y5_-curvePoint,this.x1_,this.y5_),chartCanvasId.bezierCurveTo(this.x1_,this.y5_-adjustedCurvePoint,this.x2_,this.y4_+curvePoint,this.x6_,this.y7_),chartCanvasId.bezierCurveTo(this.x6_-adjustedCurvePoint,this.y7_,this.x3_+curvePoint,this.y1_,this.x3_,this.y1_),chartCanvasId.bezierCurveTo(this.x3_+curvePoint,this.y1_,this.x2_-curvePoint,this.y2_,this.x6_,this.y6_),chartCanvasId.bezierCurveTo(this.x6_,this.y6_-adjustedCurvePoint,this.x1_,this.y3_+curvePoint,this.x1_,this.y3_),chartCanvasId.stroke()}drawSouthKundaliChartLines(chartCanvasId){chartCanvasId=document.getElementById(chartCanvasId).getContext("2d");chartCanvasId.moveTo(this.x2_,this.y3_),chartCanvasId.lineTo(this.x2_,this.y5_),chartCanvasId.moveTo(this.x4_,this.y5_),chartCanvasId.lineTo(this.x4_,this.y3_),chartCanvasId.moveTo(this.x3_,this.y2_),chartCanvasId.lineTo(this.x5_,this.y2_),chartCanvasId.moveTo(this.x5_,this.y4_),chartCanvasId.lineTo(this.x3_,this.y4_),chartCanvasId.moveTo(this.x1_,this.y3_),chartCanvasId.lineTo(this.x1_,this.y2_),chartCanvasId.moveTo(this.x1_,this.y4_),chartCanvasId.lineTo(this.x1_,this.y5_),chartCanvasId.moveTo(this.x3_,this.y1_),chartCanvasId.lineTo(this.x2_,this.y1_),chartCanvasId.moveTo(this.x4_,this.y1_),chartCanvasId.lineTo(this.x5_,this.y1_),chartCanvasId.stroke()}drawEastKundaliChartLines(chartCanvasId){chartCanvasId=document.getElementById(chartCanvasId).getContext("2d");chartCanvasId.moveTo(this.x3_,this.y6_),chartCanvasId.lineTo(this.x5_,this.y6_),chartCanvasId.moveTo(this.x3_,this.y7_),chartCanvasId.lineTo(this.x5_,this.y7_),chartCanvasId.moveTo(this.x6_,this.y3_),chartCanvasId.lineTo(this.x6_,this.y5_),chartCanvasId.moveTo(this.x7_,this.y3_),chartCanvasId.lineTo(this.x7_,this.y5_),chartCanvasId.moveTo(this.x3_,this.y3_),chartCanvasId.lineTo(this.x6_,this.y6_),chartCanvasId.moveTo(this.x5_,this.y3_),chartCanvasId.lineTo(this.x7_,this.y6_),chartCanvasId.moveTo(this.x5_,this.y5_),chartCanvasId.lineTo(this.x7_,this.y7_),chartCanvasId.moveTo(this.x3_,this.y5_),chartCanvasId.lineTo(this.x6_,this.y7_),chartCanvasId.stroke()}drawHouseNumbersOnCanvas(chartCanvasId,houseNoPositionList){var index,positionX,positionY,houseData,canvasPaintContext=document.getElementById(chartCanvasId).getContext("2d");for(index in canvasPaintContext.fillStyle=this.house_no_hex_color_,houseNoPositionList)houseNoPositionList.hasOwnProperty(index)&&(positionX=(houseData=houseNoPositionList[index])[0],positionY=houseData[1]+this.axis_y_adjustment_,houseData=houseData[2],canvasPaintContext.fillText(houseData,positionX,positionY))}drawPlanetLabelsOnCanvas(chartCanvasId,planetPositionList){var index,positionX,positionY,planetData,canvasPaintContext=document.getElementById(chartCanvasId).getContext("2d");for(index in planetPositionList)planetPositionList.hasOwnProperty(index)&&(positionX=(planetData=planetPositionList[index])[0],positionY=planetData[1]+this.axis_y_adjustment_,planetData=planetData[2],canvasPaintContext.fillStyle=this.graha_label_hex_color_list_[index.toString()],canvasPaintContext.font=this.graha_label_font_,canvasPaintContext.fontWeight="bold",canvasPaintContext.fillText(planetData,positionX,positionY))}drawZodiacLabelsOnCanvas(chartCanvasId,zodiacPositionList){var positionX,positionY,canvasPaintContext=document.getElementById(chartCanvasId).getContext("2d");if("visible"===dpCookiesMngr.getCookie("drik-chart-rashi-tags-status")){for(var index in canvasPaintContext.font=this.rashi_label_font_,canvasPaintContext.fillStyle=this.rashi_hex_color_,canvasPaintContext.globalAlpha=.5,zodiacPositionList)zodiacPositionList.hasOwnProperty(index)&&(positionX=(index=zodiacPositionList[index])[0],positionY=index[1]+this.axis_y_adjustment_,index=index[2],canvasPaintContext.fillText(index,positionX,positionY));canvasPaintContext.globalAlpha=1}}drawDrikpanchangWatermark(chartCanvasId){chartCanvasId=document.getElementById(chartCanvasId).getContext("2d");chartCanvasId.save(),chartCanvasId.font=this.watermark_font_,chartCanvasId.fillStyle=this.watermark_hex_color_,chartCanvasId.fillText(DpKundaliChartLabel.kWatermark,this.x1_-30,this.y4_-30),chartCanvasId.restore()}duplicate(newCanvasId,existingCanvasId){this.critical_points_list_[newCanvasId]=this.critical_points_list_[existingCanvasId],this.house_no_position_list_[newCanvasId]=this.house_no_position_list_[existingCanvasId],this.graha_position_list_[newCanvasId]=this.graha_position_list_[existingCanvasId],this.rashi_position_list_[newCanvasId]=this.rashi_position_list_[existingCanvasId],this.chart_style_list_[newCanvasId]=this.chart_style_list_[existingCanvasId],this.geo_tag_list_[newCanvasId]=this.geo_tag_list_[existingCanvasId]}}var dpKundaliChart=new DpKundaliChart;