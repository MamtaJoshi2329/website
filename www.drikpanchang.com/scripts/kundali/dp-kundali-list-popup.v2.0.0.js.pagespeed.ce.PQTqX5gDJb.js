"use strict";var kPopupDefaultHeight=500,kPopupDefaultWidth=400,kPopupDefaultHeightOffset=0;class DpKundaliListPopup{constructor(){this.kundali_post_url_=null,this.kundali_list_dialog_html_=null,this.kundali_list_serach_id_=null,this.kundali_list_dialog_id_=null,this.kundali_list_dialog_=null,this.dialog_title_=null,this.clicked_kundali_key_=null}showKundaliListDialog(kundaliList,kundaliTag){this.prepareToShowKundaliListDialog(kundaliTag),this.buildKundaliListDialogHTML(kundaliList),this.buildKundaliListDialog(),this.setListItemSelectionListener(),this.setDefaultKundaliListOnNoHint();kundaliTag=$("#"+this.kundali_list_serach_id_);dpPageForm.kundali_search_.prepareKundaliSearchAutocomplete(kundaliTag,this.kundali_list_dialog_)}prepareToShowKundaliListDialog(kundaliTag){DpKundaliTag.kCelebrities===kundaliTag?(this.dialog_title_=dpCelebrityKundaliLabel,this.kundali_list_dialog_id_="dp-celebrities-kundali-dialog-id",this.kundali_list_serach_id_="dp-celebrities-kundali-search",this.kundali_post_url_=DpPg.kCelebritiesKundaliList):DpKundaliTag.kAll===kundaliTag&&(this.dialog_title_=dpAllKundaliLabel,this.kundali_list_dialog_id_="dp-all-kundali-dialog-id",this.kundali_list_serach_id_="dp-all-kundali-search",this.kundali_post_url_=DpPg.kKundaliList)}buildKundaliListDialogHTML(kundaliList){this.kundali_list_dialog_html_='<div class="dpKundaliListPopupWrapper"><input type="text" class="dpKundaliInputBox dpInputBox dpInputBox1 ui-autocomplete-input" value="" id="'+this.kundali_list_serach_id_+'" placeholder="Search Name" autocomplete="off">',this.kundali_list_dialog_html_+='<div class="dpDialogKundaliListWrapper">';let self=this;kundaliList.forEach(function(kundaliDetails,kundaliIndex){var encodedKundaliDetails=encodeURIComponent(JSON.stringify(kundaliDetails));let formattedDatetime="",kundaliImage=(formattedDatetime=void 0===kundaliDetails.datetime_localized?dpPageForm.kundali_search_.getDisplayDatetimeFromMysqlTimestamp(kundaliDetails.datetime):kundaliDetails.datetime_localized,dpPageForm.kundali_search_.search_icon_),kundaliImageAlt=kundaliDetails.name;kundaliDetails.image&&0!==kundaliDetails.image.length&&(kundaliImage=kundaliDetails.image[0],kundaliImageAlt=kundaliDetails.image[1]);var userLocation=kundaliDetails.city+", "+kundaliDetails.state+", "+kundaliDetails.country,encodedKundaliDetails='<div class="dpKundaliData dpFlex dpSingleKundali" data-kundali-details="'+encodedKundaliDetails+'"><img class="dpKundaliUserIcon" src="'+kundaliImage+'" alt="'+kundaliImageAlt+'"><span class="dpKundaliDetails dpFlexEqual"><span class="dpKundaliName">'+kundaliDetails.name+'</span><br><span class="dpInlineBlock">'+formattedDatetime+'</span><br><span class="dpInlineBlock">'+userLocation+"</span></span></div>";self.kundali_list_dialog_html_+=encodedKundaliDetails}),this.kundali_list_dialog_html_+='</div></div><p class="dpExpansionNavigation dpCenterText"><a href="'+this.kundali_post_url_+'" class="dpContentLink" target="_blank">'+dpNewTabLabel+"</a></p>"}buildKundaliListDialog(){let dialogOverlay=$("#dp-page-overlay");this.kundali_list_dialog_=dpSettingsToolbar.createDialogPopup(this.kundali_list_dialog_html_,kPopupDefaultHeight,kPopupDefaultWidth,kPopupDefaultHeightOffset,this.kundali_list_dialog_id_),this.kundali_list_dialog_.bind("dialogclose",function(event,ui){dpSettingsToolbar.customizeDialogBind(event),dpPageActionbar.handleActionOnKundaliActionbarButtons(),("Escape"===event.key||void 0!==event.originalEvent&&$(event.originalEvent.currentTarget).hasClass("ui-dialog-titlebar-close"))&&(dialogOverlay.hide(),dpPageActionbar.handleKundaliButtonsOnPopupListClose())}),$("#dp-all-kundali-search, #dp-celebrities-kundali-search").trigger("focus"),this.kundali_list_dialog_.dialog("option","title",this.dialog_title_),this.kundali_list_dialog_.dialog({resizable:!1}),dialogOverlay.show().css({"z-index":5}),dialogOverlay.prop("onclick",!1).off("click")}setListItemSelectionListener(){let self=this;$(".dpSingleKundali").on("click",function(){var kundaliData=$(this).data("kundali-details"),kundaliData=JSON.parse(decodeURIComponent(kundaliData)),kundaliData=("undefined"!==kundaliData.local_kundali_key&&(self.clicked_kundali_key_=kundaliData.local_kundali_key),dpPageForm.kundali_search_.getKundaliSearchListData(kundaliData));dpPageForm.kundali_search_.selected_kundali_data_=kundaliData,self.kundali_list_dialog_.dialog("close"),dpPageForm.fillFormWithSelectedItem(kundaliData.geoData,"dp-city-search"),dpPageForm.fillFormWithSelectedKundaliItem(kundaliData.kundaliData,document.activeElement.id),dpPageForm.populateKundaliWithFormData(),dpPageActionbar.takeActionOnKundaliSelect()})}setDefaultKundaliListOnNoHint(){let input=document.getElementById(this.kundali_list_serach_id_);input.onkeydown=function(event){8===event.which&&input.value.length<=2&&$(".dpDialogKundaliListWrapper").show()}}}