"use strict";var kKundaliKeyNamePairLookupKey="kundali-key-name-lookup";class DpKundaliLocalStorage{constructor(){}populateKundaliDataInLocalStorage(originalQuery,parsedResponse){var matchedListFromLocalStorage=[],kundaliKeyNameList=this.getKundaliKeyNameList();for(let kundaliIdx=0;kundaliIdx<kundaliKeyNameList.length;kundaliIdx++){var kundaliName=kundaliKeyNameList[kundaliIdx][1].trim().toLowerCase(),updatedQuery=originalQuery.toLowerCase();-1!==kundaliName.indexOf(updatedQuery)&&matchedListFromLocalStorage.push(kundaliKeyNameList[kundaliIdx][0])}if(0<matchedListFromLocalStorage.length)for(let recordIdx=0;recordIdx<matchedListFromLocalStorage.length;recordIdx++){var matchedRecord=localStorage.getItem(matchedListFromLocalStorage[recordIdx]),matchedRecord=JSON.parse(matchedRecord);parsedResponse.kundali_list.push(matchedRecord)}}populateKundaliPopupListFromLocalStorage(parsedResponse,kundaliLimit){var kundaliRecordKey,matchedRecord,kundaliKeyNameList=this.getKundaliKeyNameList();for(let kundaliIdx=0;kundaliIdx<kundaliKeyNameList.length;kundaliIdx++)kundaliIdx!==kundaliLimit&&(kundaliRecordKey=kundaliKeyNameList[kundaliIdx][0],matchedRecord=localStorage.getItem(kundaliRecordKey),(matchedRecord=JSON.parse(matchedRecord)).local_kundali_key=kundaliRecordKey,parsedResponse.kundali_list.push(matchedRecord))}saveKundaliDataInLocalStorage(){var kundaliData,kundali=dpPageForm.secondary_context_?dpPageForm.kundali_ext_:dpPageForm.kundali_;!dpSignIn.authenticated_user_flag_&&kundali.getID<0&&(kundali=this.getKundaliLocalStorageKey(),kundaliData=this.getKundaliData(),this.saveKundaliKeyValue(kundali,kundaliData))}getKundaliData(){var kundali=dpPageForm.secondary_context_?dpPageForm.kundali_ext_:dpPageForm.kundali_,splitDDMMYYYY=kundali.getDate.split("/"),splitHHMMSS=kundali.getTime.split(":"),splitDDMMYYYY=splitDDMMYYYY[2]+"-"+splitDDMMYYYY[1]+"-"+splitDDMMYYYY[0]+" "+splitHHMMSS[0]+":"+splitHHMMSS[1]+":"+splitHHMMSS[2],splitHHMMSS=null!==kundali.getDateType?kundali.getDateType:"gregorian";return{kundali_id:-100,name:kundali.getName,gender:kundali.getGender,datetime:splitDDMMYYYY,date_type:splitHHMMSS,ayanamsha:kundali.getAyanamsha,city:kundali.geo_.getCity,state:kundali.geo_.getState,country:kundali.geo_.getCountry,latitude:kundali.geo_.getLatitude,longitude:kundali.geo_.getLongitude,olson_timezone:kundali.geo_.getOlsonTimezone,timezone_offset:kundali.geo_.getTimezoneOffset,elevation:kundali.geo_.getElevation,kundali_tag:""}}getKundaliLocalStorageKey(){var kundali=dpPageForm.secondary_context_?dpPageForm.kundali_ext_:dpPageForm.kundali_,splitDDMMYYYY=kundali.getDate.split("/"),splitHHMMSS=kundali.getTime.split(":"),name=kundali.getName,kundali=kundali.geo_.getCity,name=name.trim().toLowerCase().split(" "),kundali=kundali.trim().toLowerCase().split(" "),name=name.join(""),kundali=kundali.join("");return splitDDMMYYYY[0]+splitDDMMYYYY[1]+splitDDMMYYYY[2]+splitHHMMSS[0]+splitHHMMSS[1]+splitHHMMSS[2]+name+kundali}saveKundaliKeyValue(kundaliKey,kundaliData){kundaliData=JSON.stringify(kundaliData);localStorage.setItem(kundaliKey,kundaliData);let keyAlreadyExists=!1;var kundaliKeyNameList=this.getKundaliKeyNameList();for(let kundaliIdx=0;kundaliIdx<kundaliKeyNameList.length;kundaliIdx++)if(kundaliKey===kundaliKeyNameList[kundaliIdx][0]){keyAlreadyExists=!0;break}keyAlreadyExists||(kundaliData=(dpPageForm.secondary_context_?dpPageForm.kundali_ext_:dpPageForm.kundali_).getName,kundaliKeyNameList.push([kundaliKey,kundaliData]),kundaliData=JSON.stringify(kundaliKeyNameList),localStorage.setItem(kKundaliKeyNamePairLookupKey,kundaliData))}getKundaliKeyNameList(){try{var kundaliKeyNameJSONList=localStorage.getItem(kKundaliKeyNamePairLookupKey);let kundaliKeyNameList=JSON.parse(kundaliKeyNameJSONList);return kundaliKeyNameList=null===kundaliKeyNameJSONList?[]:kundaliKeyNameList}catch(error){return console.log(error),[]}}}