"use strict";class DpTwinKundaliHandler extends DpDialogHandler{constructor(){super(),this.clear_button_=document.getElementById("dp-clear-button"),this.submit_button_=document.getElementById("dp-submit-button")}getLoginConfirmationMessageHTML(){return'<div class="dpLeftAlignText">'+dpSignInSuggestionString+'</div><div style="padding:0 5px 20px;"><label for="dp-save-without-login"><input type="radio" id="dp-save-without-login" name="radio_button_login_option" value="'+dpWithoutLoginString+'"> '+dpWithoutLoginString+'</label><label for="dp-save-with-login"><input type="radio" id="dp-save-with-login" name="radio_button_login_option" value="'+dpLoginString+'" checked autofocus> '+dpLoginString+"</label></div>"}getDataConfirmationMessageHTML(){var kundali_=dpPageForm.kundali_,kundali_ext_=dpPageForm.kundali_ext_,geo_=kundali_.getGeo,geo_ext_=kundali_ext_.getGeo,ayanamshaElement=document.getElementById("dp-ayanamsha"),secondAyanamshaElement=document.getElementById("dp-second-ayanamsha"),selectedAyanamshaIndex=ayanamshaElement.selectedIndex,secondAyanamshaElement=secondAyanamshaElement.selectedIndex,selectedAyanamshaIndex=ayanamshaElement.options[selectedAyanamshaIndex].text,ayanamshaElement=ayanamshaElement.options[secondAyanamshaElement].text,secondAyanamshaElement="chitra-paksha"!==kundali_.getAyanamsha?" dpHighlightedAyanamsha":"",secondAyanamshaTextStyle="chitra-paksha"!==kundali_ext_.getAyanamsha?" dpHighlightedAyanamsha":"";return'<div class="dpConfirmBoxTitle">'+dpConfirmBoxTitleString+"</div><br>"+('<div class="dpLeftAlignText"><div class="dpFlex"> <div class="dpBoxLabel dpDullLabel"> </div><div class="dpConfirmBoxCell dpDullLabel">'+dpVaraDetailsString+'</div> <div class="dpConfirmBoxCell dpDullLabel">'+dpKanyaDetailsString+'</div> </div><div class="dpFlex"> <div class="dpBoxLabel dpDullLabel">'+dpNameString+'</div><div class="dpConfirmBoxCell">'+kundali_.getName+'</div> <div class="dpConfirmBoxCell">'+kundali_ext_.getName+'</div> </div><div class="dpFlex"> <div class="dpBoxLabel dpDullLabel">'+dpDateString+'</div><div class="dpConfirmBoxCell">'+kundali_.getDate+'</div> <div class="dpConfirmBoxCell">'+kundali_ext_.getDate+'</div> </div><div class="dpFlex"> <div class="dpBoxLabel dpDullLabel">'+dpTimeString+'</div><div class="dpConfirmBoxCell">'+kundali_.getTime+'</div> <div class="dpConfirmBoxCell">'+kundali_ext_.getTime+'</div> </div><div class="dpFlex"> <div class="dpBoxLabel dpDullLabel">'+dpCityString+'</div><div class="dpConfirmBoxCell">'+geo_.getCity+'</div> <div class="dpConfirmBoxCell">'+geo_ext_.getCity+'</div> </div><div class="dpFlex"> <div class="dpBoxLabel dpDullLabel">'+dpStateString+'</div><div class="dpConfirmBoxCell">'+geo_.getState+'</div> <div class="dpConfirmBoxCell">'+geo_ext_.getState+'</div> </div><div class="dpFlex"><div class="dpBoxLabel dpDullLabel">'+dpCountryString+'</div><div class="dpConfirmBoxCell">'+geo_.getCountry+'</div> <div class="dpConfirmBoxCell">'+geo_ext_.getCountry+'</div> </div> <div class="dpFlex"><div class="dpBoxLabel dpDullLabel">'+dpAyanamshaString+'</div><div class="dpConfirmBoxCell'+secondAyanamshaElement+'">'+selectedAyanamshaIndex+'</div> <div class="dpConfirmBoxCell'+secondAyanamshaTextStyle+'">'+ayanamshaElement+'</div> </div> <br><div class="dpLeftAlignText dpDullLabel"><small>'+dpPopupDateFormatString+'</small></div><div class="dpLeftAlignText dpDullLabel"><small>'+dpPopupTimeFormatString+"</small></div><br></div><br>")}showDataConfirmationDialog(){var jsErrorFlag;dpPageForm.validateKundaliForm()||(dpPageForm.secondary_context_=!0,jsErrorFlag=dpPageForm.validateKundaliForm(),dpPageForm.secondary_context_=!1,jsErrorFlag)||(jsErrorFlag=this.getDataConfirmationMessageHTML(),this.showTwinFormConfirmationBox(jsErrorFlag,this.proceedAfterDataConfirmation.bind(this),DpDialogHandler.removeActionConfirmationBoxAndOverlay))}proceedAfterDataConfirmation(){dpSignIn.authenticated_user_flag_?(this.addUserDataInCloudDatabase(),this.handleFormCollapseButtonAndFields(),DpDialogHandler.removeActionConfirmationBoxAndOverlay()):this.showSignInOptions()}handleDataOnSuccessfulSignIn(){DpDialogHandler.removeSignInOverlay(),dpPostContext=DpPostContext.kServerSignIn,this.postKundaliRequestAfterSuccessfulSignIn()}postKundaliRequestAfterSuccessfulSignIn(){var kundaliDataPayload=dpTwinKundaliPost.getAjaxRequestDataPayload(),kundaliDataPayload=JSON.stringify({dp_payload:kundaliDataPayload});dpTwinKundaliPost.postAjaxDataPayload("dp-result-content",kundaliDataPayload),this.handleFormCollapseButtonAndFields()}setContextBeforeLaunchingPopup(){dpPostContext=DpPostContext.kTwinKundali}handleDataWithoutUserSignIn(){dpPostContext=DpPostContext.kServerSignIn,document.getElementById("dp-save-without-login").checked&&(dpPageForm.kundali_.setID=-100,this.addUserDataInLocalCache(),DpDialogHandler.removeActionConfirmationBoxAndOverlay())}addUserDataInCloudDatabase(){var payloadData=dpTwinKundaliPost.getAjaxRequestDataPayload(),payloadData=JSON.stringify({dp_payload:payloadData});dpTwinKundaliPost.postAjaxDataPayload("dp-result-content",payloadData),this.handleFormCollapseButtonAndFields()}addUserDataInLocalCache(){dpPageForm.kundali_local_storage_.saveKundaliDataInLocalStorage(),dpPageForm.secondary_context_=!0,dpPageForm.kundali_local_storage_.saveKundaliDataInLocalStorage(),dpPageForm.secondary_context_=!1,this.addUserDataInCloudDatabase()}handlePopupFlowAborted(){dpPostContext=DpPostContext.kServerSignIn,DpDialogHandler.removeActionConfirmationBoxAndOverlay()}handleFormCollapseButtonAndFields(){$(".dpFormFieldsCollapse").slideUp();var expandButtonImg=$(".dpFormCollapseButton img"),secondExpandButtonImg=$(".dpFormCollapseButton-second img");expandButtonImg.attr("src",dpExpandIconURL),expandButtonImg.attr("data-alt-src",dpCompressIconURL),secondExpandButtonImg.attr("src",dpExpandIconURL),secondExpandButtonImg.attr("data-alt-src",dpCompressIconURL)}}